!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ATAmbient=e()}(this,function(){"use strict";!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}('@charset "UTF-8";\n/* 自定义样式 */\n.o2team_ambient_main {\n  position: fixed;\n  z-index: 999;\n  pointer-events: none;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0; }\n');var t="barrager".toUpperCase(),n="O2_AMBIENT_".concat(t,"_MAIN"),e="O2_AMBIENT_".concat(t,"_INIT"),i="O2_AMBIENT_".concat(t,"_CONFIG");!function(){for(var r=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window["".concat(t[e],"RequestAnimationFrame")],window.cancelAnimationFrame=window["".concat(t[e],"CancelAnimationFrame")]||window["".concat(t[e],"CancelRequestAnimationFrame")];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var n=(new Date).getTime(),i=Math.max(0,16-(n-r)),a=window.setTimeout(function(){t(n+i)},i);return r=n+i,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t};var s,u=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},c={Linear:function(t,e,n,i){return n*t/i+e},Quad:{easeIn:function(t,e,n,i){return n*(t/=i)*t+e},easeOut:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e}},Cubic:{easeIn:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOut:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e}},Quart:{easeIn:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOut:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e}},Quint:{easeIn:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOut:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e}},Sine:{easeIn:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOut:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOut:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e}},Expo:{easeIn:function(t,e,n,i){return 0==t?e:n*Math.pow(2,10*(t/i-1))+e},easeOut:function(t,e,n,i){return t==i?e+n:n*(1-Math.pow(2,-10*t/i))+e},easeInOut:function(t,e,n,i){return 0==t?e:t==i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e}},Circ:{easeIn:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOut:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e}},Elastic:{easeIn:function(t,e,n,i,a,r){if(0==t)return e;if(1==(t/=i))return e+n;if(r||(r=.3*i),!a||a<Math.abs(n)){a=n;var o=r/4}else o=r/(2*Math.PI)*Math.asin(n/a);return-a*Math.pow(2,10*(t-=1))*Math.sin((t*i-o)*(2*Math.PI)/r)+e},easeOut:function(t,e,n,i,a,r){if(0==t)return e;if(1==(t/=i))return e+n;if(r||(r=.3*i),!a||a<Math.abs(n)){a=n;var o=r/4}else o=r/(2*Math.PI)*Math.asin(n/a);return a*Math.pow(2,-10*t)*Math.sin((t*i-o)*(2*Math.PI)/r)+n+e},easeInOut:function(t,e,n,i,a,r){if(0==t)return e;if(2==(t/=i/2))return e+n;if(r||(r=i*(.3*1.5)),!a||a<Math.abs(n)){a=n;var o=r/4}else o=r/(2*Math.PI)*Math.asin(n/a);return t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*i-o)*(2*Math.PI)/r)*-.5+e:a*Math.pow(2,-10*(t-=1))*Math.sin((t*i-o)*(2*Math.PI)/r)*.5+n+e}},Back:{easeIn:function(t,e,n,i,a){return null==a&&(a=1.70158),n*(t/=i)*t*((a+1)*t-a)+e},easeOut:function(t,e,n,i,a){return null==a&&(a=1.70158),n*((t=t/i-1)*t*((a+1)*t+a)+1)+e},easeInOut:function(t,e,n,i,a){return null==a&&(a=1.70158),(t/=i/2)<1?n/2*(t*t*((1+(a*=1.525))*t-a))+e:n/2*((t-=2)*t*((1+(a*=1.525))*t+a)+2)+e}},Bounce:{easeIn:function(t,e,n,i){return n-c.Bounce.easeOut(i-t,0,n,i)+e},easeOut:function(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOut:function(t,e,n,i){return t<i/2?.5*c.Bounce.easeIn(2*t,0,n,i)+e:.5*c.Bounce.easeOut(2*t-i,0,n,i)+.5*n+e}},Pow8:{easeOut:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t*t*t*t*t+1)+e}}},h=function(){function i(t,e){var n=this;a(this,i),u(this,"toggleBarrager",function(){"visible"===n.visibleState?(n.visibleState="invisible",n.stopBarrager()):(n.visibleState="visible",n.playBarrager())}),u(this,"reset",function(t){n.opts=t||n.opts,n.endBarrager(),n.init()}),this.opts=e,this.itemData=[],this.canvas=t,this.context=t.getContext("2d"),this.visibleState="visible",this.moveFn={linear:c.Linear,easeIn:c.Quad.easeIn,easeInOut:c.Quad.easeInOut,easeOut:c.Quad.easeOut},this.itemNum=0,this.hasNum=0,this.randomKey=0,this.bindEvent()}return o(i,[{key:"bindEvent",value:function(){window.addEventListener("resize",this.reset),document.addEventListener("visibilitychange",this.toggleBarrager)}},{key:"init",value:function(){var n=this,t=this.opts,i=t.showNum,e=t.direction,a=t.width,r=t.height,o=document.documentElement.clientWidth,s=document.documentElement.clientHeight,u=a,c=r;o<a&&(u=o),s<r&&(c=s),this.canvas.style.width="".concat(u,"px"),this.canvas.style.height="".concat(c,"px"),this.width=this.canvas.width=u,this.height=this.canvas.height=c,this.allDistance="horizontal"===e?this.width:this.height;this.updateBarrager(),function t(e){n.timer=setTimeout(function(){n.updateBarrager(),i>n.hasNum&&t(Math.floor(1e3*Math.random())+500)},e)}(Math.floor(500*Math.random())),requestAnimationFrame(this.draw.bind(this))}},{key:"updateBarrager",value:function(e){var t,n=this.opts,i=n.allNum,a=n.showNum;e?(t=this.itemData.filter(function(t){return t.key!==e.key}),this.hasNum--):t=this.itemData,i>this.itemNum&&a>this.hasNum&&t.push(this.generateItem()),i<=this.itemNum&&this.destroyBarrger(),this.itemData=t}},{key:"generateItem",value:function(){var t=this.opts,e=t.opacity,n=t.speed,i=t.direction,a=t.easeType,r=t.contents,o=this.getRandomKey(),s=r[Math.floor(Math.random()*r.length)],u=Math.sqrt(s.length)/Math.sqrt(8)*n;this.width<720&&(u/=2);var c=s.length/8*150,h=Math.floor(Math.random()*this.width),m=Math.floor(Math.random()*this.height*.9);h-=h%16,m-=m%16;var l={startTime:null,x:"vertical"===i?h:0,y:"horizontal"===i?m:0,key:o,opacity:e,speed:u,direction:i,easeType:a,allDistance:this.allDistance+2*c,allTime:this.allDistance/u*1e3,content:s,offset:c,destroy:this.updateBarrager.bind(this)};return this.itemNum++,this.hasNum++,l}},{key:"getRandomKey",value:function(){return"o2h5-randow-".concat(Date.now(),"-").concat(this.randomKey++)}},{key:"drawItem",value:function(t,e){var n=t.easeType,i=t.allDistance,a=t.allTime,r=t.direction,o=t.opacity,s=t.offset;t.startTime||(t.startTime=e),t.lastTime||(t.lastTime=e);var u=e-t.lastTime;500<u&&(t.startTime=t.startTime+u);var c=e-t.startTime;if(c<a){var h=this.moveFn[n](c,0,i,a);this.context.fillStyle="rgba(255, 255, 255, ".concat(o,")"),"horizontal"===r?t.x=i-h-s:t.y=i-h-s,this.context.fillText(t.content,t.x,t.y),t.lastTime=e}else t.destroy(t)}},{key:"draw",value:function(e){var n=this,t=this.opts.fontSize;this.context.clearRect(0,0,this.width,this.height),this.context.font="".concat(t,"px 微软雅黑"),this.context.textBaseline="top",this.itemData.forEach(function(t){n.drawItem(t,e)}),this.timer=requestAnimationFrame(this.draw.bind(this))}},{key:"stopBarrager",value:function(){cancelAnimationFrame(this.timer),this.timer=null}},{key:"playBarrager",value:function(){this.timer=requestAnimationFrame(this.draw.bind(this))}},{key:"endBarrager",value:function(){this.itemData=[],this.itemNum=0,this.hasNum=0,this.context.clearRect(0,0,this.width,this.height),cancelAnimationFrame(this.timer)}},{key:"destroyBarrger",value:function(){this.stopBarrager(),this.canvas.remove()}}]),i}(),m=document.querySelector(".o2team_ambient_main");if(!m){(m=document.createElement("div")).setAttribute("class","o2team_ambient_main"),m.setAttribute("id","o2team_ambient_main");var l=document.createElement("canvas");l.setAttribute("class","canvas_wp"),l.setAttribute("id","barrager_canvas_wp"),l.setAttribute("style","display: block; margin: 0 auto;"),m.insertAdjacentElement("beforeend",l),document.body.insertAdjacentElement("beforeend",m)}function d(){try{s&&(s.endBarrager(),s=null);var t=document.getElementById("barrager_canvas_wp"),e=window[i];(s=new h(t,e)).init(),window[n]=s}catch(t){console.log(t)}}return m.addEventListener("click",function(){m.style.display="none"}),window[e]=d,window[i]={allNum:200,showNum:40,opacity:1,speed:60,direction:"horizontal",easeType:"linear",width:1960,height:1200,fontSize:14,contents:["京东超市吃货嘉年华","神券 517 减 300","5月12日到5月19日持续8天","食品全品类满 517 减 300","食品全品类满 517 减 200","食品全品类满 517 减 100","食品全品类满 517 减 50","食品全品类满 517 减 20","食品全品类满 517 减 5"]},function(e){e&&Object.keys(window[i]).forEach(function(t){void 0!==e[t]&&(window[i][t]=e[t])}),d()}});
//# sourceMappingURL=index.min.js.map
